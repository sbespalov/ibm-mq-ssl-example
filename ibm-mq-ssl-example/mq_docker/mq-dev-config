* Create channel
DEFINE CHANNEL(CF.SVRCONN) CHLTYPE(SVRCONN)

* Basic auth config
* SET CHLAUTH(CF.SVRCONN) TYPE(BLOCKUSER) USERLIST('nobody') +
* DESCR('Allow privileged users on this channel')
* SET CHLAUTH('*') TYPE(ADDRESSMAP) ADDRESS('*') USERSRC(NOACCESS) DESCR('BackStop rule')
* SET CHLAUTH(CF.SVRCONN) TYPE(ADDRESSMAP) ADDRESS('*') USERSRC(CHANNEL) CHCKCLNT(REQUIRED)
* ALTER AUTHINFO(SYSTEM.DEFAULT.AUTHINFO.IDPWOS) AUTHTYPE(IDPWOS) ADOPTCTX(YES)
* REFRESH SECURITY TYPE(CONNAUTH)

* DEFINE CHANNEL(SYSTEM.ADMIN.SVRCONN) CHLTYPE(SVRCONN)
* ALTER QMGR CHLAUTH(DISABLED)

* Create listener
DEFINE LISTENER(LIST1) TRPTYPE(TCP) PORT(1414) CONTROL(QMGR)
START LISTENER(LIST1)

* Create queues
DEFINE QLOCAL(ESB.CF.IN)
DEFINE QLOCAL(ESB.CF.OUT)
DEFINE QLOCAL(ESB.CF.REQUEST)
DEFINE QLOCAL(ESB.CF.RESPONSE)

ALTER QMGR CHLAUTH(DISABLED)
DISPLAY QMGR SSLKEYR

ALTER CHL(CF.SVRCONN) CHLTYPE(SVRCONN) SSLCIPH(RC4_MD5_US) SSLCAUTH(OPTIONAL)
REFRESH SECURITY TYPE(SSL)

ALTER QMGR CHLAUTH(ENABLED)
SET CHLAUTH('CF.SVRCONN') TYPE (SSLPEERMAP) SSLPEER('CN=*') USERSRC(MAP) MCAUSER('cf99usr')
SET CHLAUTH(CF.SVRCONN) TYPE(ADDRESSMAP) ADDRESS('*')  USERSRC(CHANNEL)
SET CHLAUTH('CF.SVRCONN') TYPE(BLOCKUSER) USERLIST(ALLOWANY)

REFRESH SECURITY TYPE(SSL)
REFRESH SECURITY TYPE(AUTHSERV)

END